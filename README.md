QWC Legend Service
===================

Acts as a proxy between the client and the OGC service for GetLegendGraphic request,
allowing to return custom legend graphics instead of the ones generated by the WMS server.

Configuration
-------------

Place your custom legend images in

    $QWC2_PATH/assets/legend/<mapid>/<layername>.png

where

 * `$QWC2_PATH` is the value of the `QWC2_PATH` environment variable
 * `<mapid>` is the id of the WMS map containing the layer
 * `<layername>` is the WMS layer name

Note that the file type must be `png`.

If the legend service cannot find a custom image, it will forward the request to the WMS server:

    <WMS_SERVER_URL>/<mapid>?SERVICE=WMS&REQUEST=GetLegendGraphic&LAYER=<layername>&....

Usage
-----

Set the `OGC_SERVER_URL` environment variable to the OGC service URL (default: `http://localhost:5013/`).
Set the `QWC2_PATH` environment variable to the path containing your QWC2 production build.


Base URL:

    http://localhost:5014/

API documentation:

    http://localhost:5014/api/

Sample request:

    http://localhost:5014/<mapid>?SERVICE=WMS&REQUEST=GetLegendGraphic&LAYER=<layername>&format=image/png&....

Development
-----------

Create a virtual environment:

    virtualenv --python=/usr/bin/python3 --system-site-packages .venv

Without system packages:

    virtualenv --python=/usr/bin/python3 .venv

Activate virtual environment:

    source .venv/bin/activate

Install requirements:

    pip install -r requirements.txt

Start local service:

    QOGC_SERVER_URL=http://localhost:5013 QWC2_PATH=qwc2/ python server.py
